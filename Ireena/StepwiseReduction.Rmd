---
title: "R Notebook"
#output: html_notebook
---
```{r}
library(tidyverse)
library(ggplot2)
library(lubridate)
library(stringr)
library(car)
```
```{r}
# Picked it up from "Datasetsmerged" notebook, where I hadcreated this file and further cleaning it 
zori_acs_cleaned= read.csv('./zori_acs_cleaned.csv', header = TRUE)
```
```{r}
zori_acs_cleaned = zori_acs_cleaned %>%
  select(., -c(Date.y, pop_5_years_over, speak_only_english_at_home, speak_spanish_at_home, speak_spanish_at_home_low_english, pop_15_and_over, pop_never_married, pop_now_married, pop_separated, pop_widowed, pop_divorced))
```
```{r}
zori_acs_cleaned = zori_acs_cleaned %>% 
  select(., -c(Date.x, zipRank, MedianZORI))
```
```{r}
# Feature Engineering. Engineered a few income related features by aggregating values in smaller bins given in file into larger ranges of income values and removed the columns used in aggregation
zacs_feat_eng = zori_acs_cleaned %>% 
  mutate(., income_0_29999 = income_less_10000 + income_10000_14999 +income_15000_19999 +income_20000_24999+income_25000_29999) %>% 
  mutate(.,income_30000_74999 = income_30000_34999 + income_35000_39999 + income_40000_44999 + income_45000_49999+ income_50000_59999+ income_60000_74999) %>% 
  mutate(., income_100000_199999 = income_100000_124999+income_125000_149999+income_150000_199999) %>% 
  select(-c(income_less_10000, income_10000_14999, income_15000_19999, income_20000_24999, income_25000_29999, income_100000_124999, income_125000_149999, income_150000_199999, income_30000_34999, income_35000_39999, income_40000_44999, income_45000_49999, income_50000_59999, income_60000_74999)) %>% 
  mutate(., vacant_housing_units_pertotal = (vacant_housing_units/housing_units), 
         occupied_housing_unis_pertotal = (occupied_housing_units/housing_units),
         mortgaged_housing_units_pertotal = (mortgaged_housing_units/housing_units),
         vacant_housing_units_forrent_pervacant_housing_units = (vacant_housing_units_for_rent)/vacant_housing_units, vacant_housing_units_for_sale_pervacant_housing_units = (vacant_housing_units_for_sale)/vacant_housing_units) %>% 
  select(-c(vacant_housing_units, housing_units, occupied_housing_units, vacant_housing_units_for_rent, vacant_housing_units_for_sale, mortgaged_housing_units)) %>%
  mutate(., dwellings_5_to_19_units = dwellings_5_to_9_units + dwellings_10_to_19_units) %>% 
  mutate(., dwellings_1_units = dwellings_1_units_attached + dwellings_1_units_detached) %>% 
  select(-c(dwellings_1_units_attached, dwellings_1_units_detached, dwellings_5_to_9_units,dwellings_10_to_19_units)) %>% 
    select(-c(bachelors_degree_2, less_than_high_school_graduate)) %>% 
  mutate(., male_70_and_over = male_70_to_74+ male_75_to_79+ male_80_to_84 + male_85_and_over) %>% 
  select(-c(male_70_to_74, male_75_to_79, male_80_to_84, male_85_and_over)) %>% 
    mutate(., female_70_and_over = female_70_to_74+female_75_to_79+female_80_to_84+ female_85_and_over) %>% 
    select(-c(female_70_to_74,female_75_to_79,female_80_to_84, female_85_and_over)) %>% 
     mutate(., female_55_through_69 = female_55_to_59 + female_60_to_61+female_62_to_64+female_65_to_66+female_67_to_69) %>%
    select(-c(female_55_to_59,female_60_to_61,female_62_to_64,female_65_to_66,female_67_to_69)) %>% 
    mutate(.,female_40_through_54 = female_40_to_44+female_45_to_49+female_50_to_54) %>% 
    select(., -c(female_40_to_44,female_45_to_49,female_50_to_54)) %>% 
    mutate(., male_through_20 = male_under_5+male_5_to_9+male_10_to_14+male_15_to_17+male_18_to_19+male_20) %>% 
    select(., -c(male_under_5, male_5_to_9, male_10_to_14, male_15_to_17, male_18_to_19, male_20)) %>% 
    mutate(., female_through_20 = female_under_5+female_5_to_9+female_10_to_14+female_15_to_17+female_18_to_19+female_20) %>% 
    select(., -c(female_under_5, female_5_to_9, female_10_to_14, female_15_to_17, female_18_to_19, female_20))
```
```{r}
# Removed some redundant columns
zacs_feat_eng = zacs_feat_eng %>% 
    select(.,-c(owner_occupied_housing_units_lower_value_quartile, owner_occupied_housing_units_upper_value_quartile, income_per_capita, commuters_16_over))
```
```{r}
zacs_feat_eng = zacs_feat_eng %>% 
  mutate(., rent_20_to_35_percent = rent_20_to_25_percent+rent_25_to_30_percent+rent_30_to_35_percent, rent_10_to_20_percent = rent_10_to_15_percent+rent_15_to_20_percent) %>% 
  select(-c(rent_20_to_25_percent,rent_25_to_30_percent, rent_30_to_35_percent, rent_10_to_15_percent, rent_15_to_20_percent)) %>% 
  select(., -c(commuters_by_carpool,commuters_drove_alone, commuters_by_subway_or_elevated, commuters_by_bus)) %>% 
  mutate(., commute_upto_14_mins = commute_less_10_mins + commute_10_14_mins) %>% 
  select(., -c(commute_less_10_mins, commute_10_14_mins)) %>% 
  mutate(., commute_15_29_mins = commute_15_19_mins + commute_20_24_mins + commute_25_29_mins,
         commute_30_44_min = commute_30_34_mins + commute_35_44_mins) %>% 
  select(., -c(commute_15_19_mins, commute_20_24_mins, commute_25_29_mins, commute_30_34_mins, commute_35_44_mins)) %>% 
  select(., -c(two_or_more_races_pop, hispanic_any_race, not_hispanic_pop)) %>% 
  select(-c(no_car))
```
```{r}
zacs_feat_eng = zacs_feat_eng %>% 
  mutate(., female_21_through_39 = female_21 + female_22_to_24+ female_25_to_29+female_30_to_34+female_35_to_39) %>% 
  select(-c( female_21, female_22_to_24, female_25_to_29, female_30_to_34, female_35_to_39)) %>% 
  select(-c(group_quarters, female_pop, children_in_single_female_hh, hispanic_male_45_54, hispanic_male_55_64,asian_male_45_54, asian_male_55_64, white_male_45_54, white_male_55_64, male_45_64_bachelors_degree, male_45_64_less_than_9_grade,male_45_64_associates_degree,male_45_64_some_college, in_grades_1_to_4,black_male_55_64, black_male_45_54, male_45_64_grade_9_12, male_45_64_high_school, in_school))
```
```{r}
zacs_feat_eng = zacs_feat_eng %>% 
  mutate(., male_21_through_39 = male_21 + male_22_to_24+ male_25_to_29+male_30_to_34+male_35_to_39) %>% 
  select(., -c(male_21, male_22_to_24, male_25_to_29, male_30_to_34, male_35_to_39)) %>% 
  mutate(., male_40_through_54 = male_40_to_44+male_45_to_49+male_50_to_54, male_55_through_69 = male_55_to_59+male_60_61+male_62_64+male_67_to_69) %>% 
  select(., -c(male_40_to_44, male_45_to_49, male_50_to_54, male_55_to_59, male_60_61, male_62_64, male_67_to_69))
```

```{r}
dim(zacs_feat_eng)
write_csv(zacs_feat_eng, "zacs_feat_eng.csv")
```

```{r}
# Leaving out all nulls. This feature "white_including_hispanic" had 32426 missing values and lot of other features had same too so selecting out non-nulls 
zori_acs_cleaned_rmnull = zacs_feat_eng %>% 
  filter(., !is.na(white_including_hispanic))
```
```{r}
#"aggregate_travel_time_to_work" had 411 missing values
zori_acs_cleaned_rmnull= zori_acs_cleaned_rmnull %>% 
  filter(., !is.na(aggregate_travel_time_to_work)) %>% 
  filter(.,!is.na(median_year_structure_built)) %>% 
  filter(., !is.na(median_rent))
```

```{r}
lapply(zori_acs_cleaned_rmnull,function(x) { length(which(is.na(x)))})
```
```{r}
dim(zori_acs_cleaned)
```

```{r}
# File before feature engineering
#write_csv(zori_acs_cleaned, "zori_acs_cleaned.csv")
```
```{r}
# After removing all the NA values, left with 122867 observations over 248 columns
dim(zori_acs_cleaned_rmnull)
```
```{r}
#Remving non-numeric columns and scaling the entire dataset
zori_acs_cleaned_rmnull = zori_acs_cleaned_rmnull %>% 
  select(-c(X, RegionID, RegionName, MsaName))
zacs_cleaned_rmnull_scaled = scale(zori_acs_cleaned_rmnull, center=TRUE, scale=TRUE)
```
```{r}
#Scaling converted it to a matrix so converting it back to dataframe for BIC analysis
zacs_cleaned_rmnull_scaled=as.data.frame(zacs_cleaned_rmnull_scaled )
```
```{r}
#library(bigstep)
y =zacs_cleaned_rmnull_scaled %>% select(ZORI)
Xbig = zacs_cleaned_rmnull_scaled %>% select(-ZORI)
data = prepare_data(y, Xbig, na=FALSE)
results = data %>% 
  reduce_matrix(minpv = 0.2) %>% 
  fast_forward(bic) %>% 
  multi_backward(bic) %>% 
  stepwise(bic)
```
```{r}
summary(results)
```
```{r}
# Taken features chosen by stepwise process above and ran a fit on them to look at VIFs
fit = lm(ZORI ~ rent_under_10_percent +                                       
median_age+                                               
black_pop+                                                   
asian_pop +                                                   
amerindian_pop +                                             
median_income +                                               
median_rent +                                              
million_dollar_housing_units+                                 
families_with_young_children +                               
commute_45_59_mins +                                      
income_200000_or_more +                                      
renter_occupied_housing_units_paying_cash_median_gross_rent +
owner_occupied_housing_units_median_value+                
dwellings_20_to_49_units +                         
dwellings_50_or_more_units +                             
mobile_homes  +                                               
black_including_hispanic+                                     
children         +                                            
commuters_by_car_truck_van  +                                
different_house_year_ago_different_city  +                   
employed_information       +                                  
gini_index        +                                           
graduate_professional_degree    +                            
male_45_64_graduate_degree  +                                
male_male_households   +                                      
no_cars            +                                         
occupation_natural_resources_construction_maintenance +       
one_car       +                                              
walked_to_work +                                              
worked_at_home +                                             
masters_degree +                                              
income_0_29999       +                                        
income_30000_74999  +                                        
dwellings_1_units  +                                          
different_house_year_ago_same_city   +                       
Year                          +                               
households_retirement_income   +                             
vacant_housing_units_for_sale_pervacant_housing_units +      
not_us_citizen_pop                +                           
percent_income_spent_on_rent    +                             
rent_10_to_20_percent  +                                      
median_year_structure_built +                                  
housing_built_2000_to_2004  +                                
employed_arts_entertainment_recreation_accommodation_food+   
three_cars                          +                        
employed_agriculture_forestry_fishing_hunting_mining  +       
SizeRank       +                                             
rent_20_to_35_percent +                                       
pop_determined_poverty_status +                              
total_pop               +                                    
housing_units_renter_occupied      +                         
vacant_housing_units_pertotal   +                             
Month                   +                                     
households            +                                       
married_households   +                                       
dwellings_5_to_19_units +                                    
female_70_and_over  +                                         
male_21_through_39   +                                        
nonfamily_households  +                                      
four_more_cars       +                                        
in_undergrad_college  +                                       
female_55_through_69  +                                       
male_40_through_54     +                                      
rent_over_50_percent   +                                     
less_one_year_college   +                                    
father_one_parent_families_with_young_children+              
commute_5_9_mins      +                                      
commute_upto_14_mins  +                                       
aggregate_travel_time_to_work +                               
commute_60_more_mins       +                                 
high_school_including_ged  +                                 
employed_pop           +                                      
associates_degree    +                                       
commute_40_44_mins    +                                      
occupation_services   +                                       
female_female_households +                                    
occupation_sales_office  +                                    
employed_retail_trade      +                                 
housing_built_1939_or_earlier, data = zacs_cleaned_rmnull_scaled)
```
```{r}
summary(fit)
```

```{r}
as.data.frame(vif(fit)) %>%
  arrange(desc(vif(fit)))
```
```{r}
# Removed "tot_pop" and Black_including_hispanic" feature that had high VIFs
fit1 = lm(ZORI ~ rent_under_10_percent +                                       
median_age+                                               
black_pop+                                                   
asian_pop +                                                   
amerindian_pop +                                             
median_income +                                               
median_rent +                                              
million_dollar_housing_units+                                 
families_with_young_children +                               
commute_45_59_mins +                                      
income_200000_or_more +                                      
renter_occupied_housing_units_paying_cash_median_gross_rent +
owner_occupied_housing_units_median_value+                
dwellings_20_to_49_units +                         
dwellings_50_or_more_units +                             
mobile_homes  +                                               
children         +                                            
commuters_by_car_truck_van  +                                
different_house_year_ago_different_city  +                   
employed_information       +                                  
gini_index        +                                           
graduate_professional_degree    +                            
male_45_64_graduate_degree  +                                
male_male_households   +                                      
no_cars            +                                         
occupation_natural_resources_construction_maintenance +       
one_car       +                                              
walked_to_work +                                              
worked_at_home +                                             
masters_degree +                                              
income_0_29999       +                                        
income_30000_74999  +                                        
dwellings_1_units  +                                          
different_house_year_ago_same_city   +                       
Year                          +                               
households_retirement_income   +                             
vacant_housing_units_for_sale_pervacant_housing_units +      
not_us_citizen_pop                +                           
percent_income_spent_on_rent    +                             
rent_10_to_20_percent  +                                      
median_year_structure_built +                                  
housing_built_2000_to_2004  +                                
employed_arts_entertainment_recreation_accommodation_food+   
three_cars                          +                        
employed_agriculture_forestry_fishing_hunting_mining  +       
SizeRank       +                                             
rent_20_to_35_percent +                                       
pop_determined_poverty_status +                              
housing_units_renter_occupied      +                         
vacant_housing_units_pertotal   +                             
Month                   +                                     
households            +                                       
married_households   +                                       
dwellings_5_to_19_units +                                    
female_70_and_over  +                                         
male_21_through_39   +                                        
nonfamily_households  +                                      
four_more_cars       +                                        
in_undergrad_college  +                                       
female_55_through_69  +                                       
male_40_through_54     +                                      
rent_over_50_percent   +                                     
less_one_year_college   +                                    
father_one_parent_families_with_young_children+              
commute_5_9_mins      +                                      
commute_upto_14_mins  +                                       
aggregate_travel_time_to_work +                               
commute_60_more_mins       +                                 
high_school_including_ged  +                                 
employed_pop           +                                      
associates_degree    +                                       
commute_40_44_mins    +                                      
occupation_services   +                                       
female_female_households +                                    
occupation_sales_office  +                                    
employed_retail_trade      +                                 
housing_built_1939_or_earlier, data = zacs_cleaned_rmnull_scaled)
```
```{r}
as.data.frame(vif(fit1)) %>%
  arrange(desc(vif(fit1)))
```
```{r}
# Removed "Household" and "pop_determined_poverty_status with  high VIFs and fitted the model again
fit2 =lm(ZORI ~ rent_under_10_percent +                                       
median_age+                                               
black_pop+                                                   
asian_pop +                                                   
amerindian_pop +                                             
median_income +                                               
median_rent +                                              
million_dollar_housing_units+                                 
families_with_young_children +                               
commute_45_59_mins +                                      
income_200000_or_more +                                      
renter_occupied_housing_units_paying_cash_median_gross_rent +
owner_occupied_housing_units_median_value+                
dwellings_20_to_49_units +                         
dwellings_50_or_more_units +                             
mobile_homes  +                                               
children         +                                            
commuters_by_car_truck_van  +                                
different_house_year_ago_different_city  +                   
employed_information       +                                  
gini_index        +                                           
graduate_professional_degree    +                            
male_45_64_graduate_degree  +                                
male_male_households   +                                      
no_cars            +                                         
occupation_natural_resources_construction_maintenance +       
one_car       +                                              
walked_to_work +                                              
worked_at_home +                                             
masters_degree +                                              
income_0_29999       +                                        
income_30000_74999  +                                        
dwellings_1_units  +                                          
different_house_year_ago_same_city   +                       
Year                          +                               
households_retirement_income   +                             
vacant_housing_units_for_sale_pervacant_housing_units +      
not_us_citizen_pop                +                           
percent_income_spent_on_rent    +                             
rent_10_to_20_percent  +                                      
median_year_structure_built +                                  
housing_built_2000_to_2004  +                                
employed_arts_entertainment_recreation_accommodation_food+   
three_cars                          +                        
employed_agriculture_forestry_fishing_hunting_mining  +       
SizeRank       +                                             
rent_20_to_35_percent +                                       
housing_units_renter_occupied      +                         
vacant_housing_units_pertotal   +                             
Month                   +                                     
married_households   +                                       
dwellings_5_to_19_units +                                    
female_70_and_over  +                                         
male_21_through_39   +                                        
nonfamily_households  +                                      
four_more_cars       +                                        
in_undergrad_college  +                                       
female_55_through_69  +                                       
male_40_through_54     +                                      
rent_over_50_percent   +                                     
less_one_year_college   +                                    
father_one_parent_families_with_young_children+              
commute_5_9_mins      +                                      
commute_upto_14_mins  +                                       
aggregate_travel_time_to_work +                               
commute_60_more_mins       +                                 
high_school_including_ged  +                                 
employed_pop           +                                      
associates_degree    +                                       
commute_40_44_mins    +                                      
occupation_services   +                                       
female_female_households +                                    
occupation_sales_office  +                                    
employed_retail_trade      +                                 
housing_built_1939_or_earlier, data = zacs_cleaned_rmnull_scaled)
```
```{r}
as.data.frame(vif(fit2)) %>%
  arrange(desc(vif(fit2)))
```
```{r}
# Removed the next 2 high VIF features i.e. 
fit3 =lm(ZORI ~ rent_under_10_percent +                                       
median_age+                                               
black_pop+                                                   
asian_pop +                                                   
amerindian_pop +                                             
median_income +                                               
median_rent +                                              
million_dollar_housing_units+                                 
families_with_young_children +                               
commute_45_59_mins +                                      
income_200000_or_more +                                      
renter_occupied_housing_units_paying_cash_median_gross_rent +
owner_occupied_housing_units_median_value+                
dwellings_20_to_49_units +                         
dwellings_50_or_more_units +                             
mobile_homes  +                                               
children         +                                            
commuters_by_car_truck_van  +                                
different_house_year_ago_different_city  +                   
employed_information       +                                  
gini_index        +                                           
graduate_professional_degree    +                            
male_45_64_graduate_degree  +                                
male_male_households   +                                      
no_cars            +                                         
occupation_natural_resources_construction_maintenance +       
one_car       +                                              
walked_to_work +                                              
worked_at_home +                                             
masters_degree +                                              
income_0_29999       +                                        
income_30000_74999  +                                        
dwellings_1_units  +                                          
different_house_year_ago_same_city   +                       
Year                          +                               
households_retirement_income   +                             
vacant_housing_units_for_sale_pervacant_housing_units +      
not_us_citizen_pop                +                           
percent_income_spent_on_rent    +                             
rent_10_to_20_percent  +                                      
median_year_structure_built +                                  
housing_built_2000_to_2004  +                                
employed_arts_entertainment_recreation_accommodation_food+   
three_cars                          +                        
employed_agriculture_forestry_fishing_hunting_mining  +       
SizeRank       +                                             
rent_20_to_35_percent +                                       
vacant_housing_units_pertotal   +                             
Month                   +                                     
married_households   +                                       
dwellings_5_to_19_units +                                    
female_70_and_over  +                                         
male_21_through_39   +                                        
nonfamily_households  +                                      
four_more_cars       +                                        
in_undergrad_college  +                                       
female_55_through_69  +                                       
male_40_through_54     +                                      
rent_over_50_percent   +                                     
less_one_year_college   +                                    
father_one_parent_families_with_young_children+              
commute_5_9_mins      +                                      
commute_upto_14_mins  +                                       
commute_60_more_mins       +                                 
high_school_including_ged  +                                 
employed_pop           +                                      
associates_degree    +                                       
commute_40_44_mins    +                                      
occupation_services   +                                       
female_female_households +                                    
occupation_sales_office  +                                    
employed_retail_trade      +                                 
housing_built_1939_or_earlier, data = zacs_cleaned_rmnull_scaled)
```
```{r}
as.data.frame(vif(fit3)) %>%
  arrange(desc(vif(fit3)))
```
```{r}
# Removed employed_pop and median rent with high VIFs of 240 and 100
fit4 =lm(ZORI ~ rent_under_10_percent +                                       
median_age+                                               
black_pop+                                                   
asian_pop +                                                   
amerindian_pop +                                             
median_income +                                               
million_dollar_housing_units+                                 
families_with_young_children +                               
commute_45_59_mins +                                      
income_200000_or_more +                                      
renter_occupied_housing_units_paying_cash_median_gross_rent +
owner_occupied_housing_units_median_value+                
dwellings_20_to_49_units +                         
dwellings_50_or_more_units +                             
mobile_homes  +                                               
children         +                                            
commuters_by_car_truck_van  +                                
different_house_year_ago_different_city  +                   
employed_information       +                                  
gini_index        +                                           
graduate_professional_degree    +                            
male_45_64_graduate_degree  +                                
male_male_households   +                                      
no_cars            +                                         
occupation_natural_resources_construction_maintenance +       
one_car       +                                              
walked_to_work +                                              
worked_at_home +                                             
masters_degree +                                              
income_0_29999       +                                        
income_30000_74999  +                                        
dwellings_1_units  +                                          
different_house_year_ago_same_city   +                       
Year                          +                               
households_retirement_income   +                             
vacant_housing_units_for_sale_pervacant_housing_units +      
not_us_citizen_pop                +                           
percent_income_spent_on_rent    +                             
rent_10_to_20_percent  +                                      
median_year_structure_built +                                  
housing_built_2000_to_2004  +                                
employed_arts_entertainment_recreation_accommodation_food+   
three_cars                          +                        
employed_agriculture_forestry_fishing_hunting_mining  +       
SizeRank       +                                             
rent_20_to_35_percent +                                       
vacant_housing_units_pertotal   +                             
Month                   +                                     
married_households   +                                       
dwellings_5_to_19_units +                                    
female_70_and_over  +                                         
male_21_through_39   +                                        
nonfamily_households  +                                      
four_more_cars       +                                        
in_undergrad_college  +                                       
female_55_through_69  +                                       
male_40_through_54     +                                      
rent_over_50_percent   +                                     
less_one_year_college   +                                    
father_one_parent_families_with_young_children+              
commute_5_9_mins      +                                      
commute_upto_14_mins  +                                       
commute_60_more_mins       +                                 
high_school_including_ged  +                                 
associates_degree    +                                       
commute_40_44_mins    +                                      
occupation_services   +                                       
female_female_households +                                    
occupation_sales_office  +                                    
employed_retail_trade      +                                 
housing_built_1939_or_earlier, data = zacs_cleaned_rmnull_scaled)
```
```{r}
as.data.frame(vif(fit4)) %>%
  arrange(desc(vif(fit4)))
```
```{r}
# Removed masters degree instead of graduate_professional_degree on top because later made more sense to me and masters seemed multicollinear
fit5=lm(ZORI ~ rent_under_10_percent +                                       
median_age+                                               
black_pop+                                                   
asian_pop +                                                   
amerindian_pop +                                             
median_income +                                               
million_dollar_housing_units+                                 
families_with_young_children +                               
commute_45_59_mins +                                      
income_200000_or_more +                                      
renter_occupied_housing_units_paying_cash_median_gross_rent +
owner_occupied_housing_units_median_value+                
dwellings_20_to_49_units +                         
dwellings_50_or_more_units +                             
mobile_homes  +                                               
children         +                                            
commuters_by_car_truck_van  +                                
different_house_year_ago_different_city  +                   
employed_information       +                                  
gini_index        +                                           
graduate_professional_degree    +                            
male_45_64_graduate_degree  +                                
male_male_households   +                                      
no_cars            +                                         
occupation_natural_resources_construction_maintenance +       
one_car       +                                              
walked_to_work +                                              
worked_at_home +                                             
income_0_29999       +                                        
income_30000_74999  +                                        
dwellings_1_units  +                                          
different_house_year_ago_same_city   +                       
Year                          +                               
households_retirement_income   +                             
vacant_housing_units_for_sale_pervacant_housing_units +      
not_us_citizen_pop                +                           
percent_income_spent_on_rent    +                             
rent_10_to_20_percent  +                                      
median_year_structure_built +                                  
housing_built_2000_to_2004  +                                
employed_arts_entertainment_recreation_accommodation_food+   
three_cars                          +                        
employed_agriculture_forestry_fishing_hunting_mining  +       
SizeRank       +                                             
rent_20_to_35_percent +                                       
vacant_housing_units_pertotal   +                             
Month                   +                                     
married_households   +                                       
dwellings_5_to_19_units +                                    
female_70_and_over  +                                         
male_21_through_39   +                                        
nonfamily_households  +                                      
four_more_cars       +                                        
in_undergrad_college  +                                       
female_55_through_69  +                                       
male_40_through_54     +                                      
rent_over_50_percent   +                                     
less_one_year_college   +                                    
father_one_parent_families_with_young_children+              
commute_5_9_mins      +                                      
commute_upto_14_mins  +                                       
commute_60_more_mins       +                                 
high_school_including_ged  +                                 
associates_degree    +                                       
commute_40_44_mins    +                                      
occupation_services   +                                       
female_female_households +                                    
occupation_sales_office  +                                    
employed_retail_trade      +                                 
housing_built_1939_or_earlier, data = zacs_cleaned_rmnull_scaled)
```
```{r}
as.data.frame(vif(fit5)) %>%
  arrange(desc(vif(fit5)))
```
```{r}
# Removed commuters_by_car_truck_van with high VIF
fit6=lm(ZORI ~ rent_under_10_percent +                                       
median_age+                                               
black_pop+                                                   
asian_pop +                                                   
amerindian_pop +                                             
median_income +                                               
million_dollar_housing_units+                                 
families_with_young_children +                               
commute_45_59_mins +                                      
income_200000_or_more +                                      
renter_occupied_housing_units_paying_cash_median_gross_rent +
owner_occupied_housing_units_median_value+                
dwellings_20_to_49_units +                         
dwellings_50_or_more_units +                             
mobile_homes  +                                               
children         +                                            
different_house_year_ago_different_city  +                   
employed_information       +                                  
gini_index        +                                           
graduate_professional_degree    +                            
male_45_64_graduate_degree  +                                
male_male_households   +                                      
no_cars            +                                         
occupation_natural_resources_construction_maintenance +       
one_car       +                                              
walked_to_work +                                              
worked_at_home +                                             
income_0_29999       +                                        
income_30000_74999  +                                        
dwellings_1_units  +                                          
different_house_year_ago_same_city   +                       
Year                          +                               
households_retirement_income   +                             
vacant_housing_units_for_sale_pervacant_housing_units +      
not_us_citizen_pop                +                           
percent_income_spent_on_rent    +                             
rent_10_to_20_percent  +                                      
median_year_structure_built +                                  
housing_built_2000_to_2004  +                                
employed_arts_entertainment_recreation_accommodation_food+   
three_cars                          +                        
employed_agriculture_forestry_fishing_hunting_mining  +       
SizeRank       +                                             
rent_20_to_35_percent +                                       
vacant_housing_units_pertotal   +                             
Month                   +                                     
married_households   +                                       
dwellings_5_to_19_units +                                    
female_70_and_over  +                                         
male_21_through_39   +                                        
nonfamily_households  +                                      
four_more_cars       +                                        
in_undergrad_college  +                                       
female_55_through_69  +                                       
male_40_through_54     +                                      
rent_over_50_percent   +                                     
less_one_year_college   +                                    
father_one_parent_families_with_young_children+              
commute_5_9_mins      +                                      
commute_upto_14_mins  +                                       
commute_60_more_mins       +                                 
high_school_including_ged  +                                 
associates_degree    +                                       
commute_40_44_mins    +                                      
occupation_services   +                                       
female_female_households +                                    
occupation_sales_office  +                                    
employed_retail_trade      +                                 
housing_built_1939_or_earlier, data = zacs_cleaned_rmnull_scaled)
```
```{r}
as.data.frame(vif(fit6)) %>%
  arrange(desc(vif(fit6)))
```
```



```{r}
zacs_cleaned_rmnull_scaled.empty = lm(ZORI ~ 1, data = zacs_cleaned_rmnull_scaled)
zacs_cleaned_rmnull_scaled.full = lm(ZORI ~ ., data = zacs_cleaned_rmnull_scaled)
scope = list(lower = formula(zacs_cleaned_rmnull_scaled.empty), upper = formula(zacs_cleaned_rmnull_scaled.full))
```
```{r}
bothBIC.empty =  step(zacs_cleaned_rmnull_scaled.empty, scope, direction = "both", k = log(122867))
```
```{r}
summary(bothBIC_zacs_features.empty)
```


